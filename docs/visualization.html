<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>16 Visualization | Statistical Analysis of Agricultural Experiments using R</title>
  <meta name="description" content="Using the R language to analyze agricultural experiments." />
  <meta name="generator" content="bookdown 0.18 and GitBook 2.6.7" />

  <meta property="og:title" content="16 Visualization | Statistical Analysis of Agricultural Experiments using R" />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="Rstats4agLogo76px.png" />
  <meta property="og:description" content="Using the R language to analyze agricultural experiments." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="16 Visualization | Statistical Analysis of Agricultural Experiments using R" />
  
  <meta name="twitter:description" content="Using the R language to analyze agricultural experiments." />
  <meta name="twitter:image" content="Rstats4agLogo76px.png" />

<meta name="author" content="Andrew Kniss &amp; Jens Streibig" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="seed-germination.html"/>

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-38934833-2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-38934833-2');
</script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Statistical Analysis of Agricultural Experiments using R</a></li>

<li class="divider"></li>
<li><a href="index.html#section"><img src="Rstats4agLogo76px.png" /></a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html"><i class="fa fa-check"></i>Preface</a><ul>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#what-is-this-text"><i class="fa fa-check"></i>What is this text?</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#cite-this-text"><i class="fa fa-check"></i>Cite this text</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#help"><i class="fa fa-check"></i><b>1.1</b> How to get help?</a><ul>
<li class="chapter" data-level="1.1.1" data-path="intro.html"><a href="intro.html#help-files"><i class="fa fa-check"></i><b>1.1.1</b> Help files</a></li>
<li class="chapter" data-level="1.1.2" data-path="intro.html"><a href="intro.html#online-help"><i class="fa fa-check"></i><b>1.1.2</b> Online help</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#install"><i class="fa fa-check"></i><b>1.2</b> Downloading and Installing R</a><ul>
<li class="chapter" data-level="1.2.1" data-path="intro.html"><a href="intro.html#cran"><i class="fa fa-check"></i><b>1.2.1</b> R packages - CRAN</a></li>
<li class="chapter" data-level="1.2.2" data-path="intro.html"><a href="intro.html#rstudio"><i class="fa fa-check"></i><b>1.2.2</b> RStudio</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="intro.html"><a href="intro.html#conventions"><i class="fa fa-check"></i><b>1.3</b> Conventions</a></li>
<li class="chapter" data-level="1.4" data-path="intro.html"><a href="intro.html#basics"><i class="fa fa-check"></i><b>1.4</b> Basics of using R</a></li>
<li class="chapter" data-level="1.5" data-path="intro.html"><a href="intro.html#loading-data-from-external-sources"><i class="fa fa-check"></i><b>1.5</b> Loading Data from External Sources</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="welcome-to-the-tidyverse.html"><a href="welcome-to-the-tidyverse.html"><i class="fa fa-check"></i><b>2</b> Welcome to the Tidyverse</a><ul>
<li class="chapter" data-level="2.1" data-path="welcome-to-the-tidyverse.html"><a href="welcome-to-the-tidyverse.html#the-dplyr-package"><i class="fa fa-check"></i><b>2.1</b> The <code>dplyr</code> package</a><ul>
<li class="chapter" data-level="2.1.1" data-path="welcome-to-the-tidyverse.html"><a href="welcome-to-the-tidyverse.html#the-dplyr-pipe"><i class="fa fa-check"></i><b>2.1.1</b> The <code>dplyr</code> pipe (<code>%&gt;%</code>)</a></li>
<li class="chapter" data-level="2.1.2" data-path="welcome-to-the-tidyverse.html"><a href="welcome-to-the-tidyverse.html#group_by-and-summarize-functions"><i class="fa fa-check"></i><b>2.1.2</b> <code>group_by()</code> and <code>summarize()</code> functions</a></li>
<li class="chapter" data-level="2.1.3" data-path="welcome-to-the-tidyverse.html"><a href="welcome-to-the-tidyverse.html#the-mutate-function"><i class="fa fa-check"></i><b>2.1.3</b> The <code>mutate()</code> function</a></li>
<li class="chapter" data-level="2.1.4" data-path="welcome-to-the-tidyverse.html"><a href="welcome-to-the-tidyverse.html#filter-and-select-functions"><i class="fa fa-check"></i><b>2.1.4</b> <code>filter()</code> and <code>select()</code> functions</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="welcome-to-the-tidyverse.html"><a href="welcome-to-the-tidyverse.html#the-tidyr-package"><i class="fa fa-check"></i><b>2.2</b> The <code>tidyr</code> package</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="descriptive-statistics.html"><a href="descriptive-statistics.html"><i class="fa fa-check"></i><b>3</b> Descriptive Statistics</a><ul>
<li class="chapter" data-level="3.1" data-path="descriptive-statistics.html"><a href="descriptive-statistics.html#calculating-group-means"><i class="fa fa-check"></i><b>3.1</b> Calculating group means</a></li>
<li class="chapter" data-level="3.2" data-path="descriptive-statistics.html"><a href="descriptive-statistics.html#calculating-other-group-statistics-with-tapply"><i class="fa fa-check"></i><b>3.2</b> Calculating other group statistics with tapply</a></li>
<li class="chapter" data-level="3.3" data-path="descriptive-statistics.html"><a href="descriptive-statistics.html#using-dplyr-to-summarize-data"><i class="fa fa-check"></i><b>3.3</b> Using dplyr to summarize data</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="simple-correlation.html"><a href="simple-correlation.html"><i class="fa fa-check"></i><b>4</b> Simple Correlation</a></li>
<li class="chapter" data-level="5" data-path="students-t-test.html"><a href="students-t-test.html"><i class="fa fa-check"></i><b>5</b> Student’s t-test</a><ul>
<li class="chapter" data-level="5.1" data-path="students-t-test.html"><a href="students-t-test.html#one-sample-t-test"><i class="fa fa-check"></i><b>5.1</b> One-sample t-test</a></li>
<li class="chapter" data-level="5.2" data-path="students-t-test.html"><a href="students-t-test.html#two-sample-t-test"><i class="fa fa-check"></i><b>5.2</b> Two-sample t-Test</a></li>
<li class="chapter" data-level="5.3" data-path="students-t-test.html"><a href="students-t-test.html#paired-t-test"><i class="fa fa-check"></i><b>5.3</b> Paired t-Test</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="anova.html"><a href="anova.html"><i class="fa fa-check"></i><b>6</b> Analysis of Variance (ANOVA)</a><ul>
<li class="chapter" data-level="6.1" data-path="anova.html"><a href="anova.html#one-way-analysis-of-variance"><i class="fa fa-check"></i><b>6.1</b> One-Way Analysis of Variance</a><ul>
<li class="chapter" data-level="6.1.1" data-path="anova.html"><a href="anova.html#checking-anova-assumptions"><i class="fa fa-check"></i><b>6.1.1</b> Checking ANOVA assumptions</a></li>
<li class="chapter" data-level="6.1.2" data-path="anova.html"><a href="anova.html#mean-separation---agricolae-package"><i class="fa fa-check"></i><b>6.1.2</b> Mean Separation - agricolae package</a></li>
<li class="chapter" data-level="6.1.3" data-path="anova.html"><a href="anova.html#mean-separation---emmeans-and-multcomp-packages"><i class="fa fa-check"></i><b>6.1.3</b> Mean Separation - emmeans and multcomp packages</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="anova.html"><a href="anova.html#multi-factor-anova"><i class="fa fa-check"></i><b>6.2</b> Multi-Factor ANOVA</a><ul>
<li class="chapter" data-level="6.2.1" data-path="anova.html"><a href="anova.html#mean-separation"><i class="fa fa-check"></i><b>6.2.1</b> Mean Separation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="linear-regression.html"><a href="linear-regression.html"><i class="fa fa-check"></i><b>7</b> Linear Regression</a><ul>
<li class="chapter" data-level="7.1" data-path="linear-regression.html"><a href="linear-regression.html#simple-linear-regression"><i class="fa fa-check"></i><b>7.1</b> Simple Linear Regression</a><ul>
<li class="chapter" data-level="7.1.1" data-path="linear-regression.html"><a href="linear-regression.html#model-diagnostics"><i class="fa fa-check"></i><b>7.1.1</b> Model Diagnostics</a></li>
<li class="chapter" data-level="7.1.2" data-path="linear-regression.html"><a href="linear-regression.html#model-interpretation"><i class="fa fa-check"></i><b>7.1.2</b> Model Interpretation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="analysis-of-covariance-ancova.html"><a href="analysis-of-covariance-ancova.html"><i class="fa fa-check"></i><b>8</b> Analysis of Covariance (ANCOVA)</a><ul>
<li class="chapter" data-level="8.1" data-path="analysis-of-covariance-ancova.html"><a href="analysis-of-covariance-ancova.html#example-1-mechanical-weed-control"><i class="fa fa-check"></i><b>8.1</b> Example 1: Mechanical Weed Control</a></li>
<li class="chapter" data-level="8.2" data-path="analysis-of-covariance-ancova.html"><a href="analysis-of-covariance-ancova.html#example-2-duration-of-competition"><i class="fa fa-check"></i><b>8.2</b> Example 2: Duration of competition</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="mixed-models-anova.html"><a href="mixed-models-anova.html"><i class="fa fa-check"></i><b>9</b> Mixed Models - ANOVA</a><ul>
<li class="chapter" data-level="9.1" data-path="mixed-models-anova.html"><a href="mixed-models-anova.html#mixed-effects-model-using-the-lme4-package"><i class="fa fa-check"></i><b>9.1</b> Mixed Effects Model using the lme4 Package</a><ul>
<li class="chapter" data-level="9.1.1" data-path="mixed-models-anova.html"><a href="mixed-models-anova.html#model-comparison-and-obtaining-p-values"><i class="fa fa-check"></i><b>9.1.1</b> Model Comparison and Obtaining P-values</a></li>
<li class="chapter" data-level="9.1.2" data-path="mixed-models-anova.html"><a href="mixed-models-anova.html#random-effects"><i class="fa fa-check"></i><b>9.1.2</b> Random Effects</a></li>
<li class="chapter" data-level="9.1.3" data-path="mixed-models-anova.html"><a href="mixed-models-anova.html#fixed-effects-mean-separation"><i class="fa fa-check"></i><b>9.1.3</b> Fixed Effects &amp; Mean Separation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="mixed-models-regression.html"><a href="mixed-models-regression.html"><i class="fa fa-check"></i><b>10</b> Mixed Models - Regression</a><ul>
<li class="chapter" data-level="10.1" data-path="mixed-models-regression.html"><a href="mixed-models-regression.html#regression-models-with-mixed-effects"><i class="fa fa-check"></i><b>10.1</b> Regression Models with Mixed Effects</a><ul>
<li class="chapter" data-level="10.1.1" data-path="mixed-models-regression.html"><a href="mixed-models-regression.html#mixedregressionex1"><i class="fa fa-check"></i><b>10.1.1</b> Example 1: Sugarbeet yield</a></li>
<li class="chapter" data-level="10.1.2" data-path="mixed-models-regression.html"><a href="mixed-models-regression.html#example-2-fungicide-toxicity"><i class="fa fa-check"></i><b>10.1.2</b> Example 2: Fungicide toxicity</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="logistic-regression-binary-response.html"><a href="logistic-regression-binary-response.html"><i class="fa fa-check"></i><b>11</b> Logistic Regression (Binary Response)</a><ul>
<li class="chapter" data-level="11.1" data-path="logistic-regression-binary-response.html"><a href="logistic-regression-binary-response.html#generalized-linear-model"><i class="fa fa-check"></i><b>11.1</b> Generalized Linear Model</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="dose-response-curves.html"><a href="dose-response-curves.html"><i class="fa fa-check"></i><b>12</b> Dose-Response curves</a><ul>
<li class="chapter" data-level="12.1" data-path="dose-response-curves.html"><a href="dose-response-curves.html#one-dose-response-curve"><i class="fa fa-check"></i><b>12.1</b> One Dose-Response Curve</a></li>
<li class="chapter" data-level="12.2" data-path="dose-response-curves.html"><a href="dose-response-curves.html#note-on-use-of-r2"><i class="fa fa-check"></i><b>12.2</b> Note on use of <span class="math inline">\(R^2\)</span></a></li>
<li class="chapter" data-level="12.3" data-path="dose-response-curves.html"><a href="dose-response-curves.html#which-dose-response-model"><i class="fa fa-check"></i><b>12.3</b> Which Dose-Response Model?</a></li>
<li class="chapter" data-level="12.4" data-path="dose-response-curves.html"><a href="dose-response-curves.html#more-dose-response-curves"><i class="fa fa-check"></i><b>12.4</b> More Dose-Response Curves</a></li>
<li class="chapter" data-level="12.5" data-path="dose-response-curves.html"><a href="dose-response-curves.html#when-upper-and-lower-limits-are-not-similar"><i class="fa fa-check"></i><b>12.5</b> When Upper and Lower Limits are not similar</a></li>
<li class="chapter" data-level="12.6" data-path="dose-response-curves.html"><a href="dose-response-curves.html#remedy-for-heterogeneous-variance"><i class="fa fa-check"></i><b>12.6</b> Remedy for heterogeneous variance</a></li>
<li class="chapter" data-level="12.7" data-path="dose-response-curves.html"><a href="dose-response-curves.html#dose-responses-with-binomial-data"><i class="fa fa-check"></i><b>12.7</b> Dose-responses with binomial data</a><ul>
<li class="chapter" data-level="12.7.1" data-path="dose-response-curves.html"><a href="dose-response-curves.html#example-1-herbicide-susceptibility"><i class="fa fa-check"></i><b>12.7.1</b> Example 1: Herbicide susceptibility</a></li>
<li class="chapter" data-level="12.7.2" data-path="dose-response-curves.html"><a href="dose-response-curves.html#example-2-earthworm-toxicity"><i class="fa fa-check"></i><b>12.7.2</b> Example 2: Earthworm toxicity</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="nonlinear-regression-selectivity-of-herbicides.html"><a href="nonlinear-regression-selectivity-of-herbicides.html"><i class="fa fa-check"></i><b>13</b> Nonlinear Regression - Selectivity of Herbicides</a><ul>
<li class="chapter" data-level="13.1" data-path="nonlinear-regression-selectivity-of-herbicides.html"><a href="nonlinear-regression-selectivity-of-herbicides.html#dose-response-curves-1"><i class="fa fa-check"></i><b>13.1</b> Dose-Response Curves</a></li>
<li class="chapter" data-level="13.2" data-path="nonlinear-regression-selectivity-of-herbicides.html"><a href="nonlinear-regression-selectivity-of-herbicides.html#assessment-of-selectivity"><i class="fa fa-check"></i><b>13.2</b> Assessment of Selectivity</a></li>
<li class="chapter" data-level="13.3" data-path="nonlinear-regression-selectivity-of-herbicides.html"><a href="nonlinear-regression-selectivity-of-herbicides.html#selectivity-index"><i class="fa fa-check"></i><b>13.3</b> Selectivity index</a></li>
<li class="chapter" data-level="13.4" data-path="nonlinear-regression-selectivity-of-herbicides.html"><a href="nonlinear-regression-selectivity-of-herbicides.html#vertical-and-horizontal-assessment"><i class="fa fa-check"></i><b>13.4</b> Vertical and Horizontal Assessment</a><ul>
<li class="chapter" data-level="13.4.1" data-path="nonlinear-regression-selectivity-of-herbicides.html"><a href="nonlinear-regression-selectivity-of-herbicides.html#vertical-assessment"><i class="fa fa-check"></i><b>13.4.1</b> Vertical assessment</a></li>
<li class="chapter" data-level="13.4.2" data-path="nonlinear-regression-selectivity-of-herbicides.html"><a href="nonlinear-regression-selectivity-of-herbicides.html#horizontal-assessment"><i class="fa fa-check"></i><b>13.4.2</b> Horizontal assessment</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="plant-competition-experiments.html"><a href="plant-competition-experiments.html"><i class="fa fa-check"></i><b>14</b> Plant Competition Experiments</a><ul>
<li class="chapter" data-level="14.1" data-path="plant-competition-experiments.html"><a href="plant-competition-experiments.html#yield-density-and-yield-loss"><i class="fa fa-check"></i><b>14.1</b> Yield, Density and Yield Loss</a></li>
<li class="chapter" data-level="14.2" data-path="plant-competition-experiments.html"><a href="plant-competition-experiments.html#replacement-series"><i class="fa fa-check"></i><b>14.2</b> Replacement Series</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="seed-germination.html"><a href="seed-germination.html"><i class="fa fa-check"></i><b>15</b> Seed Germination</a><ul>
<li class="chapter" data-level="15.1" data-path="seed-germination.html"><a href="seed-germination.html#example-1-chickweed"><i class="fa fa-check"></i><b>15.1</b> Example 1: Chickweed</a></li>
<li class="chapter" data-level="15.2" data-path="seed-germination.html"><a href="seed-germination.html#example-2-bromus-tectorum"><i class="fa fa-check"></i><b>15.2</b> Example 2: <em>Bromus tectorum</em></a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="visualization.html"><a href="visualization.html"><i class="fa fa-check"></i><b>16</b> Visualization</a><ul>
<li class="chapter" data-level="16.1" data-path="visualization.html"><a href="visualization.html#base-r-graphics"><i class="fa fa-check"></i><b>16.1</b> Base R Graphics</a><ul>
<li class="chapter" data-level="16.1.1" data-path="visualization.html"><a href="visualization.html#scatterplots"><i class="fa fa-check"></i><b>16.1.1</b> Scatterplots</a></li>
<li class="chapter" data-level="16.1.2" data-path="visualization.html"><a href="visualization.html#box-and-whisker-plots"><i class="fa fa-check"></i><b>16.1.2</b> Box and Whisker Plots</a></li>
<li class="chapter" data-level="16.1.3" data-path="visualization.html"><a href="visualization.html#more-than-two-variables"><i class="fa fa-check"></i><b>16.1.3</b> More than Two Variables</a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="visualization.html"><a href="visualization.html#ggplot2"><i class="fa fa-check"></i><b>16.2</b> ggplot2</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Statistical Analysis of Agricultural Experiments using R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="visualization" class="section level1">
<h1><span class="header-section-number">16</span> Visualization</h1>
<p>Pictures and graphs may say more than 1000 words. After collection of data, the hard work of analyzing them according to the experimental design plans begins. But before you dig too much into statistics and jump to conclusions on the basis of the statistical tests, you should actually look at the data graphically. You must try to illustrate the data in such a way that it is informative not only to you, but also to potential readers of the project or the paper you wish to publish. In a way you could look at the visualization as the interface between science and art. One of the best examples of this merger of science and art is the campaign of Napoleon in Russia 1812-1813.</p>
<div class="figure"><span id="fig:minardPlot"></span>
<img src="minardodt.png" alt="_Charles Joseph Minard (1781-1870) is most widely known for a single work, his illustration of the fate of Napoleon's Grand Army in Russia._ Source: http://www.datavis.ca/gallery/re-minard.php"  />
<p class="caption">
Figure 16.1: <em>Charles Joseph Minard (1781-1870) is most widely known for a single work, his illustration of the fate of Napoleon’s Grand Army in Russia.</em> Source: <a href="http://www.datavis.ca/gallery/re-minard.php" class="uri">http://www.datavis.ca/gallery/re-minard.php</a>
</p>
</div>
<p>Minard’s work (Figure <a href="visualization.html#fig:minardPlot">16.1</a>) has been called one of the best graphs ever produced in thematic cartography and statistical graphics. In short, it shows the size of the Army at the beginning of the attack and at the final retreat, some of the more important battles and the temperature during the retreat from Moscow. It contains so many dimensions and so much information and history that usually fill hundreds of pages in history books. Our work in weed science is rarely that exciting for the general public; although our discipline can be an esoteric at times, it plays a great role in the food production and sustainability of the farming and environment in the world.</p>
<div id="base-r-graphics" class="section level2">
<h2><span class="header-section-number">16.1</span> Base R Graphics</h2>
<p>Visualization of data is an important step to get a first impression of the quality of data and to see if some observations stand out from the rest. It can also help us observe whether the data show systematic relationships. Base R graphics are a quick and extensible way to do both this preliminary data inspection, but also for creating publication quality figures for manuscripts and presentations. We will begin this chapter with some basic examples of how to customize base R graphics to create high-quality figures.</p>
<div id="scatterplots" class="section level3">
<h3><span class="header-section-number">16.1.1</span> Scatterplots</h3>
<p>One of the most common figures is a scatter plot or x-y plot - typically used to see the relationship between an independent variable (x-axis) and a response variable (y-axis), although often used to show other relationships as well. Without much work, we can get a very simple scatterplot suitable for inspecting the data in the <code>cars</code> data set that is part of the base <code>R</code> installation (Figure <a href="visualization.html#fig:scatter1">16.2</a>).</p>
<blockquote>
<p>Code to produce Figure <a href="visualization.html#fig:scatter1">16.2</a>:</p>
</blockquote>
<div class="sourceCode" id="cb427"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb427-1" data-line-number="1"><span class="kw">plot</span>(dist <span class="op">~</span><span class="st"> </span>speed, <span class="dt">data =</span> cars, <span class="dt">main=</span><span class="st">&quot;Recorded in the 1920&#39;s&quot;</span>)</a></code></pre></div>
<div class="figure"><span id="fig:scatter1"></span>
<img src="Rstats4ag_files/figure-html/scatter1-1.png" alt="_A most basic scatterplot in R, showing the speed of cars and the distance required for the car to stop. The tilde ~ can be difficult to find on some keyboards, depending on you language, but it is the defined ASCII code 126. In Windows you can press the ALT key, activate Num. Lock and press 126._" width="672" />
<p class="caption">
Figure 16.2: <em>A most basic scatterplot in R, showing the speed of cars and the distance required for the car to stop. The tilde ~ can be difficult to find on some keyboards, depending on you language, but it is the defined ASCII code 126. In Windows you can press the ALT key, activate Num. Lock and press 126.</em>
</p>
</div>
<p>While Figure <a href="visualization.html#fig:scatter1">16.2</a> is adequate for preliminary inspection of one’s own data, it is woefully insufficient for submission to a journal. We can improve the figure greatly by making some simple additions to the basic plot code. To create Figure <a href="visualization.html#fig:scatter2">16.3</a>, the <code>par()</code> function is called to change some of the default graphing parameters. In this case we adjust the margins so that the bottom and left margins are set to 3.2, the top and right margins are set to 0.5. We have removed the main title (since that information would typically be contained in a figure caption according to most journal instructions), and also adjusted the axis labels, by setting them closer to the axis compared to default values using <code>mgp</code>. The <code>mgp</code> argument requires 3 numbers, which set the distance from the axis for the axis title, axis labels, and axis line, respectively. The defaults for <code>mgp</code> are 3, 1, 0 - so in this code we’ve removed some of the axis white space by moving the labels closer to the axis. We have also added axis labels and a main title, changed the plotting character (<code>pch=19</code>, which is a closed circle), and added some transparency to the points using the <code>rgb()</code> function and the <code>alpha</code> argument. Finally, we have, adjusted the x-axis to include 0, and removed the box around the figure by setting <code>bty=&quot;n&quot;</code>. Setting <code>bty=&quot;l&quot;</code> will leave the bottom and left lines of the box, and <code>bty=&quot;o&quot;</code> will plot the entire box (the default).</p>
<blockquote>
<p>Code to produce Figure <a href="visualization.html#fig:scatter2">16.3</a>:</p>
</blockquote>
<div class="sourceCode" id="cb428"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb428-1" data-line-number="1"><span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">c</span>(<span class="fl">3.2</span>,<span class="fl">3.2</span>,<span class="fl">0.5</span>,.<span class="dv">5</span>), <span class="dt">mgp=</span><span class="kw">c</span>(<span class="dv">2</span>,.<span class="dv">7</span>,<span class="dv">0</span>))</a>
<a class="sourceLine" id="cb428-2" data-line-number="2"><span class="kw">plot</span>(dist <span class="op">~</span><span class="st"> </span>speed, <span class="dt">data =</span> cars,</a>
<a class="sourceLine" id="cb428-3" data-line-number="3">     <span class="dt">xlab=</span><span class="st">&quot;Speed of car (mph)&quot;</span>, </a>
<a class="sourceLine" id="cb428-4" data-line-number="4">     <span class="dt">ylab=</span><span class="st">&quot;Distance required to stop (ft)&quot;</span>,</a>
<a class="sourceLine" id="cb428-5" data-line-number="5">     <span class="dt">pch=</span><span class="dv">19</span>, <span class="dt">col=</span><span class="kw">rgb</span>(<span class="dt">red=</span>.<span class="dv">3</span>, <span class="dt">blue=</span>.<span class="dv">3</span>, <span class="dt">green=</span>.<span class="dv">3</span>, <span class="dt">alpha=</span><span class="fl">0.7</span>),</a>
<a class="sourceLine" id="cb428-6" data-line-number="6">     <span class="dt">bty=</span><span class="st">&quot;n&quot;</span>, <span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">25</span>))</a></code></pre></div>
<div class="figure"><span id="fig:scatter2"></span>
<img src="Rstats4ag_files/figure-html/scatter2-1.png" alt="_An improved scatter plot showing the cars data._" width="672" />
<p class="caption">
Figure 16.3: <em>An improved scatter plot showing the cars data.</em>
</p>
</div>
</div>
<div id="box-and-whisker-plots" class="section level3">
<h3><span class="header-section-number">16.1.2</span> Box and Whisker Plots</h3>
<p>If we have some data where the “treatment” is not based upon a continuous x variable, then we can illustrate the variation with a boxplot. The data for this example <code>InsectSprays</code> are also included with the basic R installation.</p>
<blockquote>
<p>Code to produce Figure <a href="visualization.html#fig:boxjitter">16.4</a>:</p>
</blockquote>
<div class="sourceCode" id="cb429"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb429-1" data-line-number="1"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="dt">mar=</span><span class="kw">c</span>(<span class="fl">3.2</span>,<span class="fl">3.2</span>,.<span class="dv">5</span>,.<span class="dv">5</span>), <span class="dt">mgp=</span><span class="kw">c</span>(<span class="dv">2</span>,.<span class="dv">7</span>,<span class="dv">0</span>))</a>
<a class="sourceLine" id="cb429-2" data-line-number="2"><span class="kw">plot</span>(count <span class="op">~</span><span class="st"> </span>spray, <span class="dt">data =</span> InsectSprays)</a>
<a class="sourceLine" id="cb429-3" data-line-number="3">  <span class="kw">legend</span>(<span class="st">&quot;topleft&quot;</span>,<span class="st">&quot;(a)&quot;</span>, <span class="dt">bty=</span><span class="st">&quot;n&quot;</span>)</a>
<a class="sourceLine" id="cb429-4" data-line-number="4"><span class="kw">plot</span>(count <span class="op">~</span><span class="st"> </span><span class="kw">as.numeric</span>(spray), <span class="dt">data =</span> InsectSprays, <span class="dt">pch=</span><span class="dv">19</span>)</a>
<a class="sourceLine" id="cb429-5" data-line-number="5">  <span class="kw">legend</span>(<span class="st">&quot;topleft&quot;</span>,<span class="st">&quot;(b)&quot;</span>, <span class="dt">bty=</span><span class="st">&quot;n&quot;</span>)</a></code></pre></div>
<div class="figure"><span id="fig:boxjitter"></span>
<img src="Rstats4ag_files/figure-html/boxjitter-1.png" alt="_Counts of insects in agricultural experimental units treated with different insecticides._" width="672" />
<p class="caption">
Figure 16.4: <em>Counts of insects in agricultural experimental units treated with different insecticides.</em>
</p>
</div>
<p>Figure <a href="visualization.html#fig:boxjitter">16.4</a> illustrates how the default <code>plot()</code> function works in R; if the x-axis is based on factors (A through F) you automatically get a boxplot (Figure <a href="visualization.html#fig:boxjitter">16.4</a>a), where the median and the quartiles are shown, as well as an indication of extreme observations. On the other hand, if we convert the factors A through F to numerical values of x by using function <code>as.numeric()</code>, we get an ordinary continuous x variable (Figure <a href="visualization.html#fig:boxjitter">16.4</a>b). Factor A becomes 1 and factor B becomes 2 and so on. In this particular data we can change the names (e.g., F is becoming A and A becoming F) of the various sprays and it will just change the order on the x-axis. In doing so it could have a great influence on perceived relationship.</p>
<p>It is possible to combine these two panels in Figure <a href="visualization.html#fig:boxjitter">16.4</a> into a single panel, to more concisely show a high level of detail on the variance within and among treatments. To do so, we modify the code for Figure <a href="visualization.html#fig:boxjitter">16.4</a> by using <code>points()</code> instead of <code>plot()</code> for the second plot so that the points are added to the first plot instead of creating a new plotting space; jittering the points, or offsetting them slightly, in the ‘x’ direction so that counts that are similar or the same can be more easily seen; adding some transparency to the points so that we can see if multiple points are on top of one another; and by removing the outlier points from the initial boxplot since all points will be added later.</p>
<blockquote>
<p>Code to produce Figure <a href="visualization.html#fig:boxjitter2">16.5</a>:</p>
</blockquote>
<div class="sourceCode" id="cb430"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb430-1" data-line-number="1"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>), <span class="dt">mar=</span><span class="kw">c</span>(<span class="fl">3.2</span>,<span class="fl">3.2</span>,.<span class="dv">5</span>,.<span class="dv">5</span>), <span class="dt">mgp=</span><span class="kw">c</span>(<span class="dv">2</span>,.<span class="dv">7</span>,<span class="dv">0</span>))</a>
<a class="sourceLine" id="cb430-2" data-line-number="2"><span class="kw">plot</span>(count <span class="op">~</span><span class="st"> </span>spray, <span class="dt">data =</span> InsectSprays, <span class="dt">pch=</span><span class="ot">NA</span>)</a>
<a class="sourceLine" id="cb430-3" data-line-number="3"><span class="kw">points</span>(count <span class="op">~</span><span class="st"> </span><span class="kw">jitter</span>(<span class="kw">as.numeric</span>(spray)), <span class="dt">data =</span> InsectSprays,</a>
<a class="sourceLine" id="cb430-4" data-line-number="4">       <span class="dt">pch=</span><span class="dv">19</span>, <span class="dt">col=</span><span class="kw">rgb</span>(.<span class="dv">1</span>,.<span class="dv">4</span>,.<span class="dv">8</span>, <span class="dt">alpha=</span><span class="fl">0.7</span>))</a></code></pre></div>
<div class="figure"><span id="fig:boxjitter2"></span>
<img src="Rstats4ag_files/figure-html/boxjitter2-1.png" alt="_Counts of insects in agricultural experimental units treated with different insecticides - shown with points on top of the boxplots._" width="672" />
<p class="caption">
Figure 16.5: <em>Counts of insects in agricultural experimental units treated with different insecticides - shown with points on top of the boxplots.</em>
</p>
</div>
<p>For data with continuous x we can also directly call the <code>boxplot()</code> function rather than relying on <code>R</code> to correctly identify the independent variable type. We can also use some additional arguments within the <code>boxplot()</code> function to modify the look of our boxplot (Figure <a href="visualization.html#fig:horizbox">16.6</a>).</p>
<blockquote>
<p>Code to produce Figure <a href="visualization.html#fig:horizbox">16.6</a>:</p>
</blockquote>
<div class="sourceCode" id="cb431"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb431-1" data-line-number="1"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>), <span class="dt">mar=</span><span class="kw">c</span>(<span class="fl">3.2</span>,<span class="fl">8.2</span>,.<span class="dv">5</span>,.<span class="dv">5</span>), <span class="dt">mgp=</span><span class="kw">c</span>(<span class="dv">2</span>,.<span class="dv">7</span>,<span class="dv">0</span>))</a>
<a class="sourceLine" id="cb431-2" data-line-number="2"><span class="kw">boxplot</span>(count <span class="op">~</span><span class="st"> </span><span class="kw">as.numeric</span>(spray), <span class="dt">data =</span> InsectSprays, <span class="dt">horizontal=</span><span class="ot">TRUE</span>, <span class="dt">pch=</span><span class="ot">NA</span>,</a>
<a class="sourceLine" id="cb431-3" data-line-number="3">        <span class="dt">names=</span><span class="kw">c</span>(<span class="st">&quot;Antibug&quot;</span>,<span class="st">&quot;Bug Kill&quot;</span>,<span class="st">&quot;Clear&quot;</span>,<span class="st">&quot;Destroy&quot;</span>,<span class="st">&quot;Endgame&quot;</span>,<span class="st">&quot;Fuhgeddaboudit&quot;</span>),</a>
<a class="sourceLine" id="cb431-4" data-line-number="4">        <span class="dt">las=</span><span class="dv">1</span>, <span class="dt">xlab=</span><span class="st">&quot;Insect counts&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb431-5" data-line-number="5"><span class="kw">points</span>(<span class="kw">jitter</span>(<span class="kw">as.numeric</span>(spray)) <span class="op">~</span><span class="st"> </span>count, <span class="dt">data =</span> InsectSprays,</a>
<a class="sourceLine" id="cb431-6" data-line-number="6">       <span class="dt">pch=</span><span class="dv">19</span>, <span class="dt">col=</span><span class="kw">rgb</span>(.<span class="dv">1</span>,.<span class="dv">4</span>,.<span class="dv">8</span>, <span class="dt">alpha=</span><span class="fl">0.7</span>))</a></code></pre></div>
<div class="figure"><span id="fig:horizbox"></span>
<img src="Rstats4ag_files/figure-html/horizbox-1.png" alt="_The counts of insects in agricultural experimental units treated with different insecticides. Setting the option `horizontal=TRUE` creates a horizontal boxplot instead of vertical; we can use the `names` argument to add product names, and the `las` argument rotates the axis labels to horizontal._" width="672" />
<p class="caption">
Figure 16.6: <em>The counts of insects in agricultural experimental units treated with different insecticides. Setting the option <code>horizontal=TRUE</code> creates a horizontal boxplot instead of vertical; we can use the <code>names</code> argument to add product names, and the <code>las</code> argument rotates the axis labels to horizontal.</em>
</p>
</div>
</div>
<div id="more-than-two-variables" class="section level3">
<h3><span class="header-section-number">16.1.3</span> More than Two Variables</h3>
<p>One of the classical examples in statistics are the Fisher’s or Anderson’s iris data that give measurements of the sepal length and width and petal length and width, respectively, for each of three species of Iris. The <code>pairs()</code> function is a powerful (and quick) way to show the pairwise relationships between many variables at the same time.</p>
<blockquote>
<p>Code to produce Figure <a href="visualization.html#fig:sepalPairs">16.7</a>:</p>
</blockquote>
<div class="sourceCode" id="cb432"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb432-1" data-line-number="1"><span class="kw">head</span>(iris,<span class="dv">3</span>)</a></code></pre></div>
<pre><code>##   Sepal.Length Sepal.Width Petal.Length Petal.Width Species
## 1          5.1         3.5          1.4         0.2  setosa
## 2          4.9         3.0          1.4         0.2  setosa
## 3          4.7         3.2          1.3         0.2  setosa</code></pre>
<div class="sourceCode" id="cb434"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb434-1" data-line-number="1"><span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">c</span>(<span class="fl">2.2</span>,<span class="fl">2.2</span>,<span class="fl">2.2</span>,<span class="fl">2.2</span>), <span class="dt">mgp=</span><span class="kw">c</span>(<span class="dv">2</span>,.<span class="dv">7</span>,<span class="dv">0</span>))</a>
<a class="sourceLine" id="cb434-2" data-line-number="2"><span class="kw">pairs</span>(<span class="op">~</span><span class="st"> </span>Sepal.Length <span class="op">+</span><span class="st"> </span>Sepal.Width <span class="op">+</span><span class="st"> </span>Petal.Length <span class="op">+</span><span class="st"> </span>Petal.Width, <span class="dt">data=</span>iris)</a></code></pre></div>
<div class="figure"><span id="fig:sepalPairs"></span>
<img src="Rstats4ag_files/figure-html/sepalPairs-1.png" alt="_Sepal and petal measurements on 50 flowers from each of three species of Iris_: I. setosa, I. versicolor, _and_ I. virginica." width="672" />
<p class="caption">
Figure 16.7: <em>Sepal and petal measurements on 50 flowers from each of three species of Iris</em>: I. setosa, I. versicolor, <em>and</em> I. virginica.
</p>
</div>
<p>It is obvious from Figure <a href="visualization.html#fig:sepalPairs">16.7</a> that the relationships sometimes seem to be separated into two groups. However, knowing that the data are separated into three <em>Iris</em> species, we could once more use <code>as.numeric()</code> to identify which data belong to which species, and make each species a different color (Figure <a href="visualization.html#fig:sepalPairsColor">16.8</a>).</p>
<blockquote>
<p>Code to produce Figure <a href="visualization.html#fig:sepalPairsColor">16.8</a>:</p>
</blockquote>
<div class="sourceCode" id="cb435"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb435-1" data-line-number="1"><span class="kw">pairs</span>(<span class="op">~</span><span class="st"> </span>Sepal.Length <span class="op">+</span><span class="st"> </span>Sepal.Width <span class="op">+</span><span class="st"> </span>Petal.Length <span class="op">+</span><span class="st"> </span>Petal.Width, <span class="dt">data=</span>iris,</a>
<a class="sourceLine" id="cb435-2" data-line-number="2">     <span class="dt">col =</span> <span class="kw">as.numeric</span>(iris<span class="op">$</span>Species))</a></code></pre></div>
<div class="figure"><span id="fig:sepalPairsColor"></span>
<img src="Rstats4ag_files/figure-html/sepalPairsColor-1.png" alt="_By using the argument `col = as.numeric(iris$Species)` the colors separate the various species, making the differences and relationships among species obvious._" width="672" />
<p class="caption">
Figure 16.8: <em>By using the argument <code>col = as.numeric(iris$Species)</code> the colors separate the various species, making the differences and relationships among species obvious.</em>
</p>
</div>
<p>The <code>pairs()</code> function has even more power when used together with a function called <code>panel.cor()</code> that can be found at the end of the <code>?pairs</code> help page. If you find outliers in data and wish to omit them, then by using the original panel function you must omit the whole observation. Here, the function panel.cor has been improved by using the argument (<code>use = &quot;pairwise.complete.obs&quot;</code>).</p>
<div class="sourceCode" id="cb436"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb436-1" data-line-number="1">panel.cor &lt;-<span class="st"> </span><span class="cf">function</span>(x, y, <span class="dt">digits =</span> <span class="dv">2</span>, <span class="dt">prefix =</span> <span class="st">&quot;&quot;</span>, cex.cor, ...) {</a>
<a class="sourceLine" id="cb436-2" data-line-number="2">  usr &lt;-<span class="st"> </span><span class="kw">par</span>(<span class="st">&quot;usr&quot;</span>); <span class="kw">on.exit</span>(<span class="kw">par</span>(usr))</a>
<a class="sourceLine" id="cb436-3" data-line-number="3">  <span class="kw">par</span>(<span class="dt">usr =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb436-4" data-line-number="4"> r &lt;-<span class="st"> </span><span class="kw">abs</span>(<span class="kw">cor</span>(x, y, <span class="dt">use =</span> <span class="st">&quot;pairwise.complete.obs&quot;</span>))</a>
<a class="sourceLine" id="cb436-5" data-line-number="5">  txt &lt;-<span class="st"> </span><span class="kw">format</span>(<span class="kw">c</span>(r, <span class="fl">0.123456789</span>), <span class="dt">digits =</span> digits)[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb436-6" data-line-number="6">  txt &lt;-<span class="st"> </span><span class="kw">paste</span>(prefix, txt, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb436-7" data-line-number="7">  <span class="cf">if</span>(<span class="kw">missing</span>(cex.cor)) cex.cor &lt;-<span class="st"> </span><span class="fl">0.8</span><span class="op">/</span><span class="kw">strwidth</span>(txt)</a>
<a class="sourceLine" id="cb436-8" data-line-number="8">  <span class="kw">text</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>, txt, <span class="dt">cex =</span> cex.cor <span class="op">*</span><span class="st"> </span>r)</a>
<a class="sourceLine" id="cb436-9" data-line-number="9">}</a></code></pre></div>
<p>For the average R user (and even the authors of this chapter), this looks very complicated and it probably is; but by running it before you run the <code>pairs()</code> you get a fantastic overview of relationships among variables. In soils and plant sciences you often have numerous variables, i.e. elements or chemicals or morphological attributes. Before launching the statistics weaponry it would be nice to see the relationships between these variables, as we will show using the <em>Nitrate</em> data set.</p>
<div class="sourceCode" id="cb437"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb437-1" data-line-number="1">Nitrate &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="st">&quot;http://rstats4ag.org/data/nitrate.txt&quot;</span>, <span class="dt">header=</span>T)</a>
<a class="sourceLine" id="cb437-2" data-line-number="2"><span class="kw">head</span>(Nitrate,<span class="dv">3</span>)</a></code></pre></div>
<pre><code>##   age no3n   pH   Na    K
## 1   0 0.13 4.91 4.36 0.14
## 2   0 0.15 5.00 3.91 0.21
## 3   0 0.05 5.37 3.98 0.16</code></pre>
<p>We execute the <code>panel.cor()</code> function and call it within the <code>pairs()</code> function to see the relationships between all variables in the data set. Note that the correlations are absolute.</p>
<blockquote>
<p>Code to produce Figure <a href="visualization.html#fig:soilPairsPanel">16.9</a>:</p>
</blockquote>
<div class="sourceCode" id="cb439"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb439-1" data-line-number="1"><span class="kw">pairs</span>(Nitrate, <span class="dt">lower.panel =</span> panel.smooth, <span class="dt">upper.panel =</span> panel.cor)</a></code></pre></div>
<div class="figure"><span id="fig:soilPairsPanel"></span>
<img src="Rstats4ag_files/figure-html/soilPairsPanel-1.png" alt="_The lower part of the panel shows the relationships soil variables. The upper part shows the absolute correlation coefficients, the font sizes of which are based upon the magnitude of the correlation._" width="672" />
<p class="caption">
Figure 16.9: <em>The lower part of the panel shows the relationships soil variables. The upper part shows the absolute correlation coefficients, the font sizes of which are based upon the magnitude of the correlation.</em>
</p>
</div>
<p>It is clear from Figure <a href="visualization.html#fig:soilPairsPanel">16.9</a> that K has virtually no correlation with the other variables. This is solely due to an observation with a rather high K concentration, seen in the last panel row. In a case like this, it would certainly be wise to determine what is going on with that particular observation - measurement or data entry errors could be potential explainers. For now, we will exclude that observation to look at the overall trends. To do so, we can simply find the observation with the largest K-value:</p>
<div class="sourceCode" id="cb440"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb440-1" data-line-number="1"><span class="kw">which.max</span>(Nitrate[[<span class="st">&quot;K&quot;</span>]])</a></code></pre></div>
<pre><code>## [1] 10</code></pre>
<p>The maximum value is in the 10th observation. Secondly, we can change this putative outlier to a missing value (expressed as ‘NA’ in <code>R</code>). To do this, we define a new data set (<code>Nitrate1</code>) in order to not change the original data we have. We will then select the value of K that matches the maximum value of K (the 10th observation), and replace that value with ‘NA’:</p>
<div class="sourceCode" id="cb442"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb442-1" data-line-number="1">Nitrate1&lt;-Nitrate</a>
<a class="sourceLine" id="cb442-2" data-line-number="2">Nitrate1<span class="op">$</span>K[Nitrate1<span class="op">$</span>K<span class="op">==</span><span class="kw">max</span>(Nitrate1<span class="op">$</span>K)] &lt;-<span class="st"> </span><span class="ot">NA</span> <span class="co"># This is missing value in R</span></a></code></pre></div>
<p>We can then re-run the <code>pairs()</code> function on the new data set to see how removal of the outlier changes the relationship between K and the other variables.</p>
<blockquote>
<p>Code to produce Figure <a href="visualization.html#fig:pairsPanelnoOutlier">16.10</a>:</p>
</blockquote>
<div class="sourceCode" id="cb443"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb443-1" data-line-number="1"><span class="kw">pairs</span>(Nitrate1, <span class="dt">lower.panel =</span> panel.smooth, <span class="dt">upper.panel =</span> panel.cor)</a></code></pre></div>
<div class="figure"><span id="fig:pairsPanelnoOutlier"></span>
<img src="Rstats4ag_files/figure-html/pairsPanelnoOutlier-1.png" alt="_K has now gotten a higher correlation with each variable because the concentration in th 10th observation has been set to missing value.  Notice the other correlations have not changed, only K._" width="672" />
<p class="caption">
Figure 16.10: <em>K has now gotten a higher correlation with each variable because the concentration in th 10th observation has been set to missing value. Notice the other correlations have not changed, only K.</em>
</p>
</div>
<p>A field experiment, with mechanical control of weeds in cereals, was done by measuring the effect on leaf cover as a function of number of harrow runs. The harrowing was done either along the crop rows or across the crop rows at a certain stage of cereal development.</p>
<div class="sourceCode" id="cb444"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb444-1" data-line-number="1">leafCover&lt;-<span class="kw">read.csv</span>(<span class="st">&quot;http://rstats4ag.org/data/LeafCover.csv&quot;</span>)</a>
<a class="sourceLine" id="cb444-2" data-line-number="2"><span class="kw">head</span>(leafCover,<span class="dv">3</span>)</a></code></pre></div>
<pre><code>##         Leaf Intensity Direction
## 1 0.18623052         0     Along
## 2 0.12696533         1     Along
## 3 0.09006582         2     Along</code></pre>
<p>If we have more than one relationship within a data set, we can separate them as done below. There is a classification with the factors levels: Across and Along. In Figure <a href="visualization.html#fig:harrowSingle">16.11</a> you can see how you can identify the observation within harrowing Along and Across</p>
<blockquote>
<p>Code to produce Figure <a href="visualization.html#fig:harrowSingle">16.11</a>:</p>
</blockquote>
<div class="sourceCode" id="cb446"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb446-1" data-line-number="1"><span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">c</span>(<span class="fl">3.2</span>,<span class="fl">3.2</span>,.<span class="dv">5</span>,.<span class="dv">5</span>), <span class="dt">mgp=</span><span class="kw">c</span>(<span class="dv">2</span>,.<span class="dv">7</span>,<span class="dv">0</span>))</a>
<a class="sourceLine" id="cb446-2" data-line-number="2"><span class="kw">plot</span>(Leaf<span class="op">~</span>Intensity, <span class="dt">data =</span> leafCover, <span class="dt">bty=</span><span class="st">&quot;l&quot;</span>,</a>
<a class="sourceLine" id="cb446-3" data-line-number="3">     <span class="dt">pch =</span> <span class="kw">as.numeric</span>(<span class="kw">as.factor</span>(Direction)),</a>
<a class="sourceLine" id="cb446-4" data-line-number="4">     <span class="dt">xlab=</span><span class="st">&quot;Harrow intensity&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;Leaf area&quot;</span>)</a>
<a class="sourceLine" id="cb446-5" data-line-number="5"><span class="kw">legend</span>(<span class="st">&quot;bottomleft&quot;</span>, <span class="kw">levels</span>(<span class="kw">factor</span>(leafCover<span class="op">$</span>Direction)), <span class="dt">pch=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</a></code></pre></div>
<div class="figure"><span id="fig:harrowSingle"></span>
<img src="Rstats4ag_files/figure-html/harrowSingle-1.png" alt="_The leaf area of weeds and crop in relation of the intensity of harrowing either across or along the crop rows. Note how we changed Across and Along to numerical values by using the function `as.numeric()` in order to get different symbols._" width="672" />
<p class="caption">
Figure 16.11: <em>The leaf area of weeds and crop in relation of the intensity of harrowing either across or along the crop rows. Note how we changed Across and Along to numerical values by using the function <code>as.numeric()</code> in order to get different symbols.</em>
</p>
</div>
<p>Obviously, there is a relationship, and this will be properly addressed in the ANCOVA chapter. There are also other plotting facilities that can be used the <code>xyplot()</code> in the package,lattice, which comes with basic R.</p>
<blockquote>
<p>Code to produce Figure <a href="visualization.html#fig:harrowLattice">16.12</a></p>
</blockquote>
<div class="sourceCode" id="cb447"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb447-1" data-line-number="1"><span class="kw">library</span>(lattice)</a>
<a class="sourceLine" id="cb447-2" data-line-number="2"><span class="kw">xyplot</span>(Leaf <span class="op">~</span><span class="st"> </span>Intensity <span class="op">|</span><span class="st"> </span>Direction, <span class="dt">data =</span> leafCover)</a></code></pre></div>
<div class="figure"><span id="fig:harrowLattice"></span>
<img src="Rstats4ag_files/figure-html/harrowLattice-1.png" alt="_The individual plots for each classification variable. Notice that the variable after the `|` defines the classification._" width="672" />
<p class="caption">
Figure 16.12: <em>The individual plots for each classification variable. Notice that the variable after the <code>|</code> defines the classification.</em>
</p>
</div>
</div>
</div>
<div id="ggplot2" class="section level2">
<h2><span class="header-section-number">16.2</span> ggplot2</h2>
<p>Within the R community there is an array of versatile packages to visualize data, we have barely scratched the surface showing a few examples we felt may be of immediate interest. The numbers of graphic interfaces are numerous and increasing, some are easier to use than others, and sometimes it takes a rather large amount of time to get the hang of it. One package that has received a great deal of (much-deserved) praise is <code>ggplot2</code>. The ‘gg’ branding is “the grammar of graphics.”</p>
<p>We will not spend too much time discussing the syntax of <code>ggplot2</code>, but we will provide several examples of plots created in this package to illustrate its powerful and elegant capabilities. We can begin by using the same <code>leafCover</code> data in Figures <a href="visualization.html#fig:harrowSingle">16.11</a> and <a href="visualization.html#fig:harrowLattice">16.12</a>. In the ‘gg’ way of doing things, we first provide the data set and the primary variables of interest, then continue adding on additional layers to the plot, separated by a <code>+</code>.</p>
<blockquote>
<p>Code to produce Figure<a href="visualization.html#fig:ggharrow">16.13</a></p>
</blockquote>
<div class="sourceCode" id="cb448"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb448-1" data-line-number="1"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb448-2" data-line-number="2"></a>
<a class="sourceLine" id="cb448-3" data-line-number="3"><span class="kw">ggplot</span>(leafCover, <span class="kw">aes</span>(<span class="dt">x=</span>Intensity, <span class="dt">y=</span>Leaf)) <span class="op">+</span></a>
<a class="sourceLine" id="cb448-4" data-line-number="4"><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">color=</span>Direction, <span class="dt">shape=</span>Direction)) <span class="op">+</span></a>
<a class="sourceLine" id="cb448-5" data-line-number="5"><span class="st">  </span><span class="kw">stat_smooth</span>(<span class="kw">aes</span>(<span class="dt">color=</span>Direction, <span class="dt">linetype=</span>Direction), <span class="dt">method=</span><span class="st">&quot;lm&quot;</span>, <span class="dt">se=</span><span class="ot">TRUE</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb448-6" data-line-number="6"><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Leaf area&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;Harrow intensity&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb448-7" data-line-number="7"><span class="st">  </span><span class="kw">theme_classic</span>() <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;right&quot;</span>) </a></code></pre></div>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<div class="figure"><span id="fig:ggharrow"></span>
<img src="Rstats4ag_files/figure-html/ggharrow-1.png" alt="_Harrowing intensity data shown using ggplot2._" width="672" />
<p class="caption">
Figure 16.13: <em>Harrowing intensity data shown using ggplot2.</em>
</p>
</div>
<p>One of the strengths of the <code>ggplot2</code> package is the ability to use linear or local regression models using the <code>stat_smooth()</code> function, as shown in Figure <a href="visualization.html#fig:ggharrow">16.13</a>. In this example, the linear model fit is drawn in the same colors as the points, and a gray shaded area is added that represents the standard error. All of these options can be customized (for example, by changing to <code>se=FALSE</code> to remove the error shading).</p>
<p>To create a barplot with confidence intervals from a one way analysis of variance, ANOVA, we can again use the <code>InsectSprays</code> data set, and start by generating the linear model. The next step is to turn the relevant results from the ANOVA into a data.frame, for use in plotting, then passing that information along to the <code>geom_bar()</code> and <code>geom_errorbar()</code> functions within <code>ggplot</code>.</p>
<div class="sourceCode" id="cb450"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb450-1" data-line-number="1">m1&lt;-<span class="kw">lm</span>(count<span class="op">~</span>spray<span class="dv">-1</span>,<span class="dt">data=</span>InsectSprays)</a>
<a class="sourceLine" id="cb450-2" data-line-number="2"><span class="co">#Note the -1 presents the parameteres as sheer means not as differences </span></a>
<a class="sourceLine" id="cb450-3" data-line-number="3"><span class="kw">coef</span>(m1) <span class="co">#the means</span></a></code></pre></div>
<pre><code>##    sprayA    sprayB    sprayC    sprayD    sprayE    sprayF 
## 14.500000 15.333333  2.083333  4.916667  3.500000 16.666667</code></pre>
<div class="sourceCode" id="cb452"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb452-1" data-line-number="1"><span class="kw">confint</span>(m1) <span class="co">#the conficence intervals</span></a></code></pre></div>
<pre><code>##             2.5 %    97.5 %
## sprayA 12.2395786 16.760421
## sprayB 13.0729119 17.593755
## sprayC -0.1770881  4.343755
## sprayD  2.6562453  7.177088
## sprayE  1.2395786  5.760421
## sprayF 14.4062453 18.927088</code></pre>
<div class="sourceCode" id="cb454"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb454-1" data-line-number="1">d.frame.m1&lt;-<span class="kw">data.frame</span>(<span class="kw">cbind</span>(<span class="kw">coef</span>(m1),<span class="kw">confint</span>(m1)),<span class="dt">pest=</span><span class="kw">rownames</span>(<span class="kw">confint</span>(m1))) <span class="co">#Combining the two</span></a>
<a class="sourceLine" id="cb454-2" data-line-number="2"><span class="kw">head</span>(d.frame.m1,<span class="dv">2</span>)</a></code></pre></div>
<pre><code>##              V1   X2.5..  X97.5..   pest
## sprayA 14.50000 12.23958 16.76042 sprayA
## sprayB 15.33333 13.07291 17.59375 sprayB</code></pre>
<p>The results are provided in Figure <a href="visualization.html#fig:ggSprayBar">16.14</a>. When doing an ANOVA to separate treatment effect it is not correct to give the standard error of the replicates within a treatment. It is based upon too few observations and essentially is a waste of ink. The only correct way is to use the ANOVA standard error. The trained weed and crop scientists will know this rather simple use of ANOVA results is not obeyed in a large proportion of papers with tables that give the individual treatments standard errors. But because this redundant presentation of data is generally accepted in most journals, whatever their impact factors, it should be discouraged.</p>
<blockquote>
<p>Code to produce Figure<a href="visualization.html#fig:ggSprayBar">16.14</a></p>
</blockquote>
<div class="sourceCode" id="cb456"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb456-1" data-line-number="1"><span class="kw">ggplot</span>(d.frame.m1, <span class="kw">aes</span>(<span class="dt">x=</span>pest, <span class="dt">y=</span>V1)) <span class="op">+</span></a>
<a class="sourceLine" id="cb456-2" data-line-number="2"><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat=</span><span class="st">&quot;identity&quot;</span>, <span class="dt">fill=</span><span class="st">&quot;lightgreen&quot;</span>,</a>
<a class="sourceLine" id="cb456-3" data-line-number="3">           <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb456-4" data-line-number="4"><span class="st">  </span><span class="kw">geom_errorbar</span>(<span class="kw">aes</span>(<span class="dt">ymin=</span><span class="kw">pmax</span>(X2.<span class="dv">5</span>..,<span class="dv">0</span>), </a>
<a class="sourceLine" id="cb456-5" data-line-number="5">                    <span class="dt">ymax=</span>X97.<span class="dv">5</span>..), <span class="dt">width=</span><span class="fl">0.5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb456-6" data-line-number="6"><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Pesticide Spray&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb456-7" data-line-number="7"><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Insect Counts&quot;</span>)</a></code></pre></div>
<div class="figure"><span id="fig:ggSprayBar"></span>
<img src="Rstats4ag_files/figure-html/ggSprayBar-1.png" alt="_InsectSpray data in a barplot with 95 % confidence intervals using the ggplot2 package._" width="672" />
<p class="caption">
Figure 16.14: <em>InsectSpray data in a barplot with 95 % confidence intervals using the ggplot2 package.</em>
</p>
</div>
<p>Paired barplots are another (more complicated, but often useful) way of arranging barplots. This is relevant for some factorial or split-plot designs. For example using data from a study looking at five crop species each grown in two different row orientations (east-west vs north-south), it makes sense to group the data by crops to look for consistent trends of row orientation (Figure <a href="visualization.html#fig:ggCropOrient">16.15</a>).</p>
<blockquote>
<p>Code to produce Figure<a href="visualization.html#fig:ggCropOrient">16.15</a></p>
</blockquote>
<div class="sourceCode" id="cb457"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb457-1" data-line-number="1">CropRowOrientation&lt;-<span class="kw">read.csv</span>(<span class="st">&quot;http://rstats4ag.org/data/CropRowOrientation.csv&quot;</span>)</a>
<a class="sourceLine" id="cb457-2" data-line-number="2"><span class="kw">head</span>(CropRowOrientation)</a></code></pre></div>
<pre><code>##          Crop          Row Yield
## 1      Barley    East-west  1149
## 2       Wheat    East-west  1195
## 3      Canola    East-west   626
## 4   Field pea    East-west   500
## 5      Lupine    East-west   493
## 6      Barley  North-south   856</code></pre>
<div class="sourceCode" id="cb459"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb459-1" data-line-number="1">c &lt;-<span class="st"> </span><span class="kw">ggplot</span>(CropRowOrientation)</a>
<a class="sourceLine" id="cb459-2" data-line-number="2">c <span class="op">+</span><span class="st"> </span><span class="kw">aes</span>(<span class="dt">x =</span> Crop, <span class="dt">y =</span> Yield, <span class="dt">fill =</span> Row, <span class="dt">color =</span> Row) <span class="op">+</span></a>
<a class="sourceLine" id="cb459-3" data-line-number="3"><span class="st">      </span><span class="kw">geom_bar</span>(<span class="dt">stat=</span><span class="st">&quot;identity&quot;</span>, <span class="dt">width=</span>.<span class="dv">5</span>, <span class="dt">position=</span><span class="st">&quot;dodge&quot;</span>)</a></code></pre></div>
<div class="figure"><span id="fig:ggCropOrient"></span>
<img src="Rstats4ag_files/figure-html/ggCropOrient-1.png" alt="The effect of the orientation of crop sowing on the yield five crops. The illustration is based on means not raw data, so there are no error bars." width="672" />
<p class="caption">
Figure 16.15: The effect of the orientation of crop sowing on the yield five crops. The illustration is based on means not raw data, so there are no error bars.
</p>
</div>
<hr />

</div>
</div>






<div id="disqus_thread"></div>
<script>

(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = 'https://rstats4ag.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
            </section>

          </div>
        </div>
      </div>
<a href="seed-germination.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Rstats4ag.pdf", "Rstats4ag.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
